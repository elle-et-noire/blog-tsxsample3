<!DOCTYPE html><html lang="ja"><head><meta property="og:type" content="website"/><meta property="og:site_name" content="jamband/blog"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/><title>Nuxt.js と Bootstrap 5 · jamband/blog</title><meta name="description" content="Bootstrap 5 もそろそろ安定版がリリースされそうな雰囲気なので (2020.08.03 現在の最新は 5.0.0-alpha1) 、最近よく触っている Nuxt.js と"/><meta property="og:title" content="Nuxt.js と Bootstrap 5 ･ jamband/blog"/><meta property="og:description" content="Bootstrap 5 もそろそろ安定版がリリースされそうな雰囲気なので (2020.08.03 現在の最新は 5.0.0-alpha1) 、最近よく触っている Nuxt.js と"/><meta property="og:url" content="https://jamband.github.io/blog/2020/08/nuxtjs-bootstrap5"/><meta name="next-head-count" content="7"/><link rel="preload" href="/blog-tsxsample3/_next/static/css/3aa9fac633eeab01.css" as="style"/><link rel="stylesheet" href="/blog-tsxsample3/_next/static/css/3aa9fac633eeab01.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/blog-tsxsample3/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/blog-tsxsample3/_next/static/chunks/webpack-d4274a9fa7773368.js" defer=""></script><script src="/blog-tsxsample3/_next/static/chunks/framework-6e4ba497ae0c8a3f.js" defer=""></script><script src="/blog-tsxsample3/_next/static/chunks/main-a370f1e8f0b61adf.js" defer=""></script><script src="/blog-tsxsample3/_next/static/chunks/pages/_app-12f7e1c190babb18.js" defer=""></script><script src="/blog-tsxsample3/_next/static/chunks/919-231013f5e47261ba.js" defer=""></script><script src="/blog-tsxsample3/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bslug%5D-3d0d7b5b21b5a35b.js" defer=""></script><script src="/blog-tsxsample3/_next/static/-mSpNxblT_7qXLgt3RP1-/_buildManifest.js" defer=""></script><script src="/blog-tsxsample3/_next/static/-mSpNxblT_7qXLgt3RP1-/_ssgManifest.js" defer=""></script><script src="/blog-tsxsample3/_next/static/-mSpNxblT_7qXLgt3RP1-/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="flex flex-col min-h-screen"><header><nav class="fixed w-full py-3 z-20 text-center font-semibold bg-gray-800" aria-label="Header navigation"><a class="px-5 py-3 no-underline font-mono tracking-tight" href="/blog-tsxsample3/"><span class="text-xs text-gray-100 duration-1000">jamband<!-- -->/</span><span class="text-pink-500 opacity-80 duration-1000">blog</span></a></nav></header><main class="flex-grow container mx-auto pt-28 pb-10"><div class="style_initial__lfW24" role="status"></div><div><article><header class="mb-8"><h1 class="mb-10">Nuxt.js と Bootstrap 5</h1><div class="italic text-right text-sm text-gray-400"><time dateTime="2020-08-03">Aug 03, 2020</time></div></header><div class="post"><h2>はじめに</h2>
<p>Bootstrap 5 もそろそろ安定版がリリースされそうな雰囲気なので (2020.08.03 現在の最新は 5.0.0-alpha1) 、最近よく触っている Nuxt.js と組み合わせて使ってみた感想を書いていく。</p>
<h2>環境</h2>
<ul>
<li>Nuxt.js 2.14.x</li>
<li>Bootstrap 5.0.0-alpha1</li>
<li>nuxt-purgecss 1.0.x</li>
</ul>
<h2>試してみたかったこと</h2>
<p>Bootstrap も 5.x 系から jQuery への依存をやめたり (オプションでまだ使えるようにはなっている) 、IE のサポートを切ったり (IE のサポートが必要な場合は 4.x を使う) 、といろいろ気になるところはあるが、自分が個人的に気になっていたところは、<a href="https://bootstrap-vue.org/" target="_blank" rel="nofollow noopener noreferrer">BootstrapVue</a> を使用せずに使えるかどうかと、<a href="https://vue-loader.vuejs.org/guide/css-modules.html" target="_blank" rel="nofollow noopener noreferrer">CSS Modules</a> と組み合わせて使っても、良い感じに <a href="https://purgecss.com/" target="_blank" rel="nofollow noopener noreferrer">PurgeCSS</a> が効くかどうかという点だ。</p>
<p><a href="https://react-bootstrap.github.io/" target="_blank" rel="nofollow noopener noreferrer">React Bootstrap</a> や <a href="https://bootstrap-vue.org/" target="_blank" rel="nofollow noopener noreferrer">BootstrapVue</a> などは Bootstrap の JavaScript 部分を独自に実装していて、かつアクセシビリティの考慮もされているので非常に便利だが、それとは引き換えに残念ながら PurgeCSS とは非常に相性が悪いように思う。カスタムな Sass 構成にして、使用する CSS コンポーネントなどのみをインポートして使うようにしても、なかなか効果的なファイルサイズの削減とはいかない。</p>
<p>といった感じで、Bootstrap 4.x では React Bootstrap や BootstrapVue と PurgeCSS の組み合わせは諦めていたが、5.x からは jQuery への依存もないので、モジュールをインポートして、コンポーネントの props に値を入れていく代わりに、ほぼほぼ生の形で HTML タグの class/className 属性にそのままぽいぽいと用意されたクラスを適用していけばいいので、これ PurgeCSS とも相性がよくなるよね？と期待したわけだ。</p>
<p>また、ほぼほぼ生の形で HTML  タグが構成されるので CSS Modules の使用も簡単になり、これはぜひ試してみようと思い、Nuxt.js と Bootstrap 5 の組み合わせで簡単な Examples サイトを作ることになった。</p>
<h2>試してみてわかったこと</h2>
<p>Vue.js や Nuxt.js において今までコンポーネントへのスタイリングは <a href="https://vue-loader.vuejs.org/guide/scoped-css.html" target="_blank" rel="nofollow noopener noreferrer">Scoped CSS</a> を使っていたが、今回はこれまた PurgeCSS との相性が悪い CSS Modules をあえて使って、どうにかこうにか Bootstrap 5 も絡めて、いい感じに PurgeCSS が効くか試してみたかった。</p>
<p>Nuxt.js における CSS Modules は Vue.js と同様に <a href="https://vue-loader.vuejs.org/" target="_blank" rel="nofollow noopener noreferrer">vue-loader</a> がいろいろやってくれるわけだが、コードとしては以下のように記述する:</p>
<div class="remark-highlight"><pre data-file="pages/index.vue" class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span>template<span class="token operator">></span>
  <span class="token operator">&#x3C;</span>p <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"$style.red"</span><span class="token operator">></span>
    <span class="token maybe-class-name">This</span> should be red
  <span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&#x3C;</span><span class="token operator">/</span>template<span class="token operator">></span>

<span class="token operator">&#x3C;</span>style module<span class="token operator">></span>
<span class="token punctuation">.</span><span class="token property-access">red</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&#x3C;</span><span class="token operator">/</span>style<span class="token operator">></span>
</code></pre></div>
<p>生成される HTML は以下のようになる:</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!-- スタイル部分 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">data-vue-ssr-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>xxx<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
<span class="token comment">/* something... */</span>
<span class="token selector"><span class="token class">.red_3LoVX</span></span> <span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> <span class="token color">red</span> <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>

<span class="token comment">&#x3C;!-- body タグ内 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>red_3LoVX<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  This should be red
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
</code></pre></div>
<p>Scoped CSS とは違い、クラス名の suffix にハッシュ値が自動で付与されるので、クラス名の衝突を防ぐことができ、長ったらしいクラス名にしなくてもいい、という利点がある。</p>
<p>ただ、ここで問題になったのは PurgeCSS との組み合わせである。Nuxt.js において PurgeCSS を使う場合、公式では <a href="https://github.com/Developmint/nuxt-purgecss" target="_blank" rel="nofollow noopener noreferrer">nuxt-purgecss</a> を利用できるよと書いてあったので使ってみたわけだが、CSS Modules には対応しておらず、そのままだと定義されたスタイルがデッドコードであってもなくても purge されてしまうので、何かしらの対処が必要になった。</p>
<p><a href="https://github.com/Developmint/nuxt-purgecss/blob/master/lib/utils.js" target="_blank" rel="nofollow noopener noreferrer">nuxt-purgecss のデフォルトの設定</a> を見てみると、extractors 箇所で Vue のインラインスタイル部分の削除が行われ、結果して CSS Modules と噛み合わなくなるので、この部分を上書きして無効にし、purge されるのを防ぐことにした。</p>
<p>設定ファイル:</p>
<div class="remark-highlight"><pre data-file="nuxt.config.js" class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token literal-property property">purgeCSS</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token function-variable function">extractors</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>結果として .vue ファイルのスタイル部分にデッドコードが存在しても purge されないわけだが、Bootstrap 5 を使う場合、用意されている変数をカスタマイズしていき、用意されているクラスを適用していって、不足分は Utility API で追加していってという感じで、実際 Scoped CSS/CSS Modules を使う箇所というのはかなり限られてくるので、そこはきっちり監視しなくてもいいや、という感じにした。</p>
<p>Bootstrap 5 のコンポーネントにおける JavaScript モジュールの読み込みに関しては特にこれといった問題はなかった。mounted() なりでモジュールを require すればいい。</p>
<p>その他の細かな部分はリポジトリを公開しているので興味のある人は見てほしい。</p>
<h2>完成したもの</h2>
<ul>
<li><a href="https://quietz.netlify.app/" target="_blank" rel="nofollow noopener noreferrer">Quietz</a></li>
<li><a href="https://github.com/jamband/quietz" target="_blank" rel="nofollow noopener noreferrer">Quietz のリポジトリ</a></li>
</ul>
<h2>まとめ</h2>
<p>PurgeCSS との相性を考えると <a href="https://tailwindcss.com/" target="_blank" rel="nofollow noopener noreferrer">TailwindCSS</a>  がやっぱり良いなぁとは思うけど、Bootstrap も Utilities がけっこう充実してきて、ある程度細かなスタイリングもできるようになったし、Dropdown や Modal  などはモジュールを読み込んであーだこーだするとすぐ使えるし、相変わらず CSS/UI Framework は便利だけど、いろいろ悩ましいなぁと思う。</p>
<h2>関連リンク</h2>
<ul>
<li><a href="https://nuxtjs.org/" target="_blank" rel="nofollow noopener noreferrer">Nuxt.js</a></li>
<li><a href="https://getbootstrap.com/" target="_blank" rel="nofollow noopener noreferrer">Bootstrap</a></li>
<li><a href="https://purgecss.com/" target="_blank" rel="nofollow noopener noreferrer">PurgeCSS</a></li>
<li><a href="https://quietz.netlify.app/" target="_blank" rel="nofollow noopener noreferrer">Quietz</a></li>
</ul>
</div><p class="mt-16 text-center"><a class="px-5 py-3 font-semibold" href="/blog-tsxsample3/">Home</a></p></article></div></main><div class="mb-3 font-semibold text-center text-xs text-gray-500">© 2022 Tomoki Morita</div><footer class="py-3 text-center font-semibold bg-gray-800"><nav class="text-sm" aria-label="Footer navigation"><a class="px-5 py-3" href="/blog-tsxsample3/about/">About</a><a class="px-5 py-3" href="/blog-tsxsample3/contact/">Contact</a></nav></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Nuxt.js と Bootstrap 5","date":"2020-08-03","tags":["nuxt","css"],"year":"2020","month":"08","slug":"nuxtjs-bootstrap5","content":"\u003ch2\u003eはじめに\u003c/h2\u003e\n\u003cp\u003eBootstrap 5 もそろそろ安定版がリリースされそうな雰囲気なので (2020.08.03 現在の最新は 5.0.0-alpha1) 、最近よく触っている Nuxt.js と組み合わせて使ってみた感想を書いていく。\u003c/p\u003e\n\u003ch2\u003e環境\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eNuxt.js 2.14.x\u003c/li\u003e\n\u003cli\u003eBootstrap 5.0.0-alpha1\u003c/li\u003e\n\u003cli\u003enuxt-purgecss 1.0.x\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e試してみたかったこと\u003c/h2\u003e\n\u003cp\u003eBootstrap も 5.x 系から jQuery への依存をやめたり (オプションでまだ使えるようにはなっている) 、IE のサポートを切ったり (IE のサポートが必要な場合は 4.x を使う) 、といろいろ気になるところはあるが、自分が個人的に気になっていたところは、\u003ca href=\"https://bootstrap-vue.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eBootstrapVue\u003c/a\u003e を使用せずに使えるかどうかと、\u003ca href=\"https://vue-loader.vuejs.org/guide/css-modules.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eCSS Modules\u003c/a\u003e と組み合わせて使っても、良い感じに \u003ca href=\"https://purgecss.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ePurgeCSS\u003c/a\u003e が効くかどうかという点だ。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://react-bootstrap.github.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eReact Bootstrap\u003c/a\u003e や \u003ca href=\"https://bootstrap-vue.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eBootstrapVue\u003c/a\u003e などは Bootstrap の JavaScript 部分を独自に実装していて、かつアクセシビリティの考慮もされているので非常に便利だが、それとは引き換えに残念ながら PurgeCSS とは非常に相性が悪いように思う。カスタムな Sass 構成にして、使用する CSS コンポーネントなどのみをインポートして使うようにしても、なかなか効果的なファイルサイズの削減とはいかない。\u003c/p\u003e\n\u003cp\u003eといった感じで、Bootstrap 4.x では React Bootstrap や BootstrapVue と PurgeCSS の組み合わせは諦めていたが、5.x からは jQuery への依存もないので、モジュールをインポートして、コンポーネントの props に値を入れていく代わりに、ほぼほぼ生の形で HTML タグの class/className 属性にそのままぽいぽいと用意されたクラスを適用していけばいいので、これ PurgeCSS とも相性がよくなるよね？と期待したわけだ。\u003c/p\u003e\n\u003cp\u003eまた、ほぼほぼ生の形で HTML  タグが構成されるので CSS Modules の使用も簡単になり、これはぜひ試してみようと思い、Nuxt.js と Bootstrap 5 の組み合わせで簡単な Examples サイトを作ることになった。\u003c/p\u003e\n\u003ch2\u003e試してみてわかったこと\u003c/h2\u003e\n\u003cp\u003eVue.js や Nuxt.js において今までコンポーネントへのスタイリングは \u003ca href=\"https://vue-loader.vuejs.org/guide/scoped-css.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eScoped CSS\u003c/a\u003e を使っていたが、今回はこれまた PurgeCSS との相性が悪い CSS Modules をあえて使って、どうにかこうにか Bootstrap 5 も絡めて、いい感じに PurgeCSS が効くか試してみたかった。\u003c/p\u003e\n\u003cp\u003eNuxt.js における CSS Modules は Vue.js と同様に \u003ca href=\"https://vue-loader.vuejs.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003evue-loader\u003c/a\u003e がいろいろやってくれるわけだが、コードとしては以下のように記述する:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre data-file=\"pages/index.vue\" class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003etemplate\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n  \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003ep \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"$style.red\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n    \u003cspan class=\"token maybe-class-name\"\u003eThis\u003c/span\u003e should be red\n  \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003ep\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003etemplate\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\n\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003estyle module\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ered\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e red\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003estyle\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e生成される HTML は以下のようになる:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token comment\"\u003e\u0026#x3C;!-- スタイル部分 --\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003edata-vue-ssr-id\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003exxx\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n\u003cspan class=\"token comment\"\u003e/* something... */\u003c/span\u003e\n\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.red_3LoVX\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token property\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token color\"\u003ered\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e\u0026#x3C;!-- body タグ内 --\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ep\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ered_3LoVX\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  This should be red\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eScoped CSS とは違い、クラス名の suffix にハッシュ値が自動で付与されるので、クラス名の衝突を防ぐことができ、長ったらしいクラス名にしなくてもいい、という利点がある。\u003c/p\u003e\n\u003cp\u003eただ、ここで問題になったのは PurgeCSS との組み合わせである。Nuxt.js において PurgeCSS を使う場合、公式では \u003ca href=\"https://github.com/Developmint/nuxt-purgecss\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003enuxt-purgecss\u003c/a\u003e を利用できるよと書いてあったので使ってみたわけだが、CSS Modules には対応しておらず、そのままだと定義されたスタイルがデッドコードであってもなくても purge されてしまうので、何かしらの対処が必要になった。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/Developmint/nuxt-purgecss/blob/master/lib/utils.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003enuxt-purgecss のデフォルトの設定\u003c/a\u003e を見てみると、extractors 箇所で Vue のインラインスタイル部分の削除が行われ、結果して CSS Modules と噛み合わなくなるので、この部分を上書きして無効にし、purge されるのを防ぐことにした。\u003c/p\u003e\n\u003cp\u003e設定ファイル:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre data-file=\"nuxt.config.js\" class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003edefault\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// ...\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003epurgeCSS\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// ...\u003c/span\u003e\n    \u003cspan class=\"token function-variable function\"\u003eextractors\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e結果として .vue ファイルのスタイル部分にデッドコードが存在しても purge されないわけだが、Bootstrap 5 を使う場合、用意されている変数をカスタマイズしていき、用意されているクラスを適用していって、不足分は Utility API で追加していってという感じで、実際 Scoped CSS/CSS Modules を使う箇所というのはかなり限られてくるので、そこはきっちり監視しなくてもいいや、という感じにした。\u003c/p\u003e\n\u003cp\u003eBootstrap 5 のコンポーネントにおける JavaScript モジュールの読み込みに関しては特にこれといった問題はなかった。mounted() なりでモジュールを require すればいい。\u003c/p\u003e\n\u003cp\u003eその他の細かな部分はリポジトリを公開しているので興味のある人は見てほしい。\u003c/p\u003e\n\u003ch2\u003e完成したもの\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://quietz.netlify.app/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eQuietz\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/jamband/quietz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eQuietz のリポジトリ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eまとめ\u003c/h2\u003e\n\u003cp\u003ePurgeCSS との相性を考えると \u003ca href=\"https://tailwindcss.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eTailwindCSS\u003c/a\u003e  がやっぱり良いなぁとは思うけど、Bootstrap も Utilities がけっこう充実してきて、ある程度細かなスタイリングもできるようになったし、Dropdown や Modal  などはモジュールを読み込んであーだこーだするとすぐ使えるし、相変わらず CSS/UI Framework は便利だけど、いろいろ悩ましいなぁと思う。\u003c/p\u003e\n\u003ch2\u003e関連リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://nuxtjs.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eNuxt.js\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://getbootstrap.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eBootstrap\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://purgecss.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ePurgeCSS\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://quietz.netlify.app/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eQuietz\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/[year]/[month]/[slug]","query":{"year":"2020","month":"08","slug":"nuxtjs-bootstrap5"},"buildId":"-mSpNxblT_7qXLgt3RP1-","assetPrefix":"/blog-tsxsample3","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>